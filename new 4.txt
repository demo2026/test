@Bean
public DefaultErrorHandler kafkaErrorHandler() {
    DefaultErrorHandler errorHandler = new DefaultErrorHandler((record, ex) -> {
        log.error("Kafka ErrorHandler caught exception for record: {}, Error: {}", record, ex.getMessage(), ex);
        // You can add logic for retries or DLQs here
    });
    // You may set retry/backoff/recovery logic if desired
    return errorHandler;
}

@Bean
public KafkaListenerContainerFactory<?> kafkaListenerContainerFactory() {
    ConcurrentKafkaListenerContainerFactory<Object, Object> factory = new ConcurrentKafkaListenerContainerFactory<>();
    factory.setConsumerFactory(consumerFactory());
    factory.setCommonErrorHandler(kafkaErrorHandler());
    return factory;
}
